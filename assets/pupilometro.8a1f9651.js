import{L as p}from"./index.4ffd6295.js";const i=p("");fetch("/versao.json").then(async o=>{const t=await o.json();i.value=t.versao}).catch(async()=>{const t=await(await fetch(`/${new URL(location.href).pathname.split("/")[1]}/versao.json`)).json();i.value=t.versao});var u={versao:i};const l={foto:"",fotoOriginal:"",medidas:{},calcularDistanciasCartao:function(){let o=l.medidas;o.cartao.distanciapx=Math.hypot(Math.abs(o.cartao.p2.left-o.cartao.p1.left),Math.abs(o.cartao.p1.top-o.cartao.p2.top)),o.fator=o.cartao.distanciapx/o.cartao.tamanho,o.dip.total=Math.hypot(Math.abs(o.olhoDireito.centroOlho.left-o.olhoEsquerdo.centroOlho.left),Math.abs(o.olhoDireito.centroOlho.top-o.olhoEsquerdo.centroOlho.top))/o.fator;const t=(o.olhoDireito.centroOlho.top+o.olhoEsquerdo.centroOlho.top)/2;o.dnp.od=Math.hypot(Math.abs(o.olhoDireito.centroOlho.left-o.nariz.left),Math.abs(t-o.olhoDireito.centroOlho.top))/o.fator,o.dnp.oe=Math.hypot(Math.abs(o.olhoEsquerdo.centroOlho.left-o.nariz.left),Math.abs(t-o.olhoEsquerdo.centroOlho.top))/o.fator},calcularDistancias:function(){let o=l.medidas;const t=Math.hypot(Math.abs(o.olhoDireito.superior.left-o.olhoEsquerdo.superior.left),Math.abs(o.olhoDireito.superior.top-o.olhoEsquerdo.superior.top))/o.tamanhoArmacao;o.fator=t,o.tamanhoArmacaoPx=o.tamanhoArmacao*t,o.dip.total=Math.hypot(Math.abs(o.olhoDireito.centroOlho.left-o.olhoEsquerdo.centroOlho.left),Math.abs(o.olhoDireito.centroOlho.top-o.olhoEsquerdo.centroOlho.top))/t,o.dip.od.altura=(o.olhoDireito.inferior.top-o.olhoDireito.centroOlho.top)/t,o.dip.oe.altura=(o.olhoEsquerdo.inferior.top-o.olhoEsquerdo.centroOlho.top)/t,o.dnp.od=(o.tamanhoArmacaoPx/2-(o.olhoDireito.centroOlho.left-o.olhoDireito.superior.left))/t,o.dnp.oe=(o.tamanhoArmacaoPx/2-(o.olhoEsquerdo.superior.left-o.olhoEsquerdo.centroOlho.left))/t,o.ponte=(o.olhoEsquerdo.inferior.left-o.olhoDireito.inferior.left)/t,o.bifocalOlhoEsquerdo=o.olhoEsquerdo.bifocalAltura/t,o.bifocalOlhoDireito=o.olhoDireito.bifocalAltura/t,o.diagonal.distanciapx=Math.hypot(Math.abs(o.diagonal.p2.left-o.diagonal.p1.left),Math.abs(o.diagonal.p1.top-o.diagonal.p2.top)),o.diagonal.distancia=o.diagonal.distanciapx/t,o.alturaArmacaoPx=(o.olhoDireito.inferior.top-o.olhoDireito.superior.top+(o.olhoEsquerdo.inferior.top-o.olhoEsquerdo.superior.top))/2,o.alturaArmacao=o.alturaArmacaoPx/t},ler:async o=>{},async leFoto({id:o,tipoFoto:t}){const e=localStorage.getItem("bancoDeDados");try{const a=await $db.arquivo.le({name:`${e}/pupilometro/${o}/${o}_${t}`});return URL.createObjectURL(a)}catch(a){console.error("Erro ao ler foto online",a)}try{const a=await $db.arquivo.le({id:o});return URL.createObjectURL(a)}catch(a){console.error("Erro ao ler foto offline",a)}},async gravaFoto({base64:o,idPupilometro:t,tipoFoto:e}){const a=o.substring(11,o.indexOf(";base64"));await $db.arquivo.grava({original:{},atual:{arquivo:o,dataCriacao:$utils.dataAtual(),id:`${t}_${e}`,idTabelaMaster:t,nome:`${t}_${e}.${a}`,tipoArquivo:"pupilometro"}})},leListaCompleta:async o=>{var n,s;const{where:t,limit:e,page:a,sort:c,dir:h}=o,r=await $utils.geeksApi({listaPupilometro:{funcao:"53A62883-A918-496D-9AA4-972B983045F4",where:t,limit:e,page:a,sort:c,dir:h}});return(s=(n=r==null?void 0:r.data)==null?void 0:n.listaPupilometro)!=null?s:[]},limpar:function(){this.foto="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAQAAAAkGDomAAAATklEQVR42u3OMQEAAAgDINc/9Czh4QEJSDuvRVBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUPDSAovln7Gzmi7KAAAAAElFTkSuQmCC",this.fotoOriginal="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAQAAAAkGDomAAAATklEQVR42u3OMQEAAAgDINc/9Czh4QEJSDuvRVBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUPDSAovln7Gzmi7KAAAAAElFTkSuQmCC",this.medidas={tipo:"Pupilometro",tamanhoArmacao:100,tamanhoArmacaoPx:0,alturaArmacao:0,alturaArmacaoPx:0,olhoDireito:{superior:{left:257,top:462},centroOlho:{left:421,top:549},inferior:{left:540,top:699},bifocalAltura:0},olhoEsquerdo:{superior:{left:950,top:463},centroOlho:{left:784,top:549},inferior:{left:665,top:699},bifocalAltura:0},nariz:{left:0,top:0},dip:{total:0,od:{altura:0},oe:{altura:0}},dnp:{od:0,oe:0},ponte:0,bifocal:!1,bifocalOlhoEsquerdo:0,bifocalOlhoDireito:0,fator:0,diagonal:{p1:{left:0,top:0},p2:{left:0,top:0},distancia:0,distanciapx:0},cartao:{p1:{left:0,top:0},p2:{left:0,top:0},distancia:0,distanciapx:0,tamanho:86.6}}},obterImagemCameraInput:async function(){return new Promise(o=>{const t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept","image/*"),t.setAttribute("capture","environment"),t.addEventListener("cancel",e=>{o(null)}),t.addEventListener("change",()=>{const e=t.files;if(FileReader&&e&&e.length){const a=new FileReader;a.onload=async()=>{o(a.result)},a.readAsDataURL(e[0])}}),t.click()})}};l.limpar();export{u as a,l as p};
